{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Description" : "Route 53 Hosted Zone Sub-Domain Setup",
  "Parameters" : {
    "CustomerName" : {
      "Description"   : "Customer Name",
      "Type"          : "String"
    },
    "ProjectName" : {
      "Description"   : "Project Name",
      "Type"          : "String"
    },
    "ENV" : {
      "Description"   : "Environment (dev, tst, qat, prd)",
      "Type"          : "String",
      "AllowedValues" : [
        "dev",
        "tst",
        "qat",
        "prd"
        ],
      "Default"       : "dev"
    },
    "DomainName" : {
      "Description" : "Top Level domain name",
      "Type" : "String"
    }
  },
  "Resources" : {
   "DNS" : {
     "Type" : "AWS::Route53::HostedZone",
      "Properties" : {
        "HostedZoneConfig" : { "Comment" : "HostZone for Development"},
        "Name": { "Fn::Join" : [ "", [ { "Ref": "ENV" }, ".", { "Ref": "ProjectName" }, ".", { "Ref" : "DomainName" }, "." ] ] },
        "HostedZoneTags" : [ 
          { "Key" : "Customer",    "Value" : { "Ref" : "CustomerName" } },
          { "Key" : "Project",     "Value" : { "Ref" : "ProjectName" } },
          { "Key" : "Environment", "Value" : { "Ref" : "ENV" } } 
        ]
      }
    }
  },
  
  "Outputs" : {
    "HostedZone" : {
      "Description" : "HostZone ID",
      "Value" : { "Ref" : "DNS" },
      "Export" : {
        "Name" : { "Fn::Join" : [ "-", [ { "Ref" : "ProjectName" }, "HostedZoneId" ] ] }
      }
    }
  }
}